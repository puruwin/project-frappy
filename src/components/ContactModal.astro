---
interface Props {
  plan?: string;
}

const FORM_ENDPOINT = "https://formspree.io/f/mjkglyjd";
const { plan = "Básico" } = Astro.props;
---

<div id="contactModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-[100] flex items-center justify-center p-4">
  <div class="bg-[var(--color-background)] w-full max-w-2xl relative" style="
    border: var(--border-brutal);
    box-shadow: var(--shadow-brutal);
  ">
    <button id="closeModal" class="absolute -top-4 -right-4 bg-black text-white w-8 h-8 flex items-center justify-center font-bold z-10" style="
      border: var(--border-brutal);
    ">×</button>

    <div class="p-4 sm:p-6">
      <h3 class="text-lg sm:text-xl lg:text-2xl font-bold mb-3 sm:mb-4 font-['JetBrains_Mono_Variable']">
        Plan {plan}
      </h3>

      <form action={FORM_ENDPOINT} method="POST" id="contactForm" class="grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4">
        <div class="sm:col-span-2">
          <label class="block mb-1 font-['JetBrains_Mono_Variable'] text-sm" for="name">
            Nombre
          </label>
          <input 
            type="text" 
            id="name" 
            name="name" 
            required
            class="w-full p-2 bg-white font-['Montserrat_Variable'] text-sm"
            style="border: var(--border-brutal);"
          />
        </div>

        <div>
          <label class="block mb-1 font-['JetBrains_Mono_Variable'] text-sm" for="email">
            Correo Electrónico
          </label>
          <input 
            type="email" 
            id="email" 
            name="email" 
            required
            class="w-full p-2 bg-white font-['Montserrat_Variable'] text-sm"
            style="border: var(--border-brutal);"
          />
        </div>

        <div>
          <label class="block mb-1 font-['JetBrains_Mono_Variable'] text-sm" for="phone">
            Teléfono
          </label>
          <input 
            type="tel" 
            id="phone" 
            name="phone" 
            required
            class="w-full p-2 bg-white font-['Montserrat_Variable'] text-sm"
            style="border: var(--border-brutal);"
          />
        </div>

        <div class="sm:col-span-2">
          <label class="block mb-1 font-['JetBrains_Mono_Variable'] text-sm" for="message">
            Cuéntanos sobre tu proyecto
          </label>
          <textarea 
            id="message" 
            name="message" 
            rows="2"
            class="w-full p-2 bg-white font-['Montserrat_Variable'] text-sm resize-none"
            style="border: var(--border-brutal);"
          ></textarea>
        </div>

        <div class="sm:col-span-2 flex flex-col sm:flex-row gap-3">
          <button 
            type="submit"
            class="flex-1 bg-black text-white py-2 px-4 font-['JetBrains_Mono_Variable'] hover:bg-gray-800 transition-colors text-sm"
            style="border: var(--border-brutal);"
          >
            Enviar
          </button>
          
          <a 
            href="https://wa.me/+34608962213" 
            target="_blank"
            class="flex-1 bg-[#25D366] text-white py-2 px-4 font-['JetBrains_Mono_Variable'] hover:bg-[#128C7E] transition-colors text-center text-sm"
            style="border: var(--border-brutal);"
          >
            WhatsApp
          </a>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  const modal = document.getElementById('contactModal');
  const closeBtn = document.getElementById('closeModal');
  const form = document.getElementById('contactForm');

  // Cerrar modal
  closeBtn?.addEventListener('click', () => {
    modal?.classList.add('hidden');
  });

  // Cerrar al hacer click fuera
  modal?.addEventListener('click', (e) => {
    if (e.target === modal) {
      modal.classList.add('hidden');
    }
  });

  // Manejar envío del formulario
  form?.addEventListener('submit', (e) => {
    e.preventDefault();
    // Aquí puedes añadir la lógica para enviar el formulario
    console.log('Formulario enviado');
  });
</script> 